"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[8559],{6828:(pt,X,V)=>{V.d(X,{R:()=>m});var B=V(3953);let m=(()=>{var R;class w{constructor(){}setItem(C,G){localStorage.setItem(C,G)}getItem(C){return localStorage.getItem(C)||null}removeItem(C){localStorage.removeItem(C)}clear(){localStorage.clear()}}return(R=w).\u0275fac=function(C){return new(C||R)},R.\u0275prov=B.jDH({token:R,factory:R.\u0275fac,providedIn:"root"}),w})()},224:(pt,X,V)=>{V.d(X,{tc:()=>It,gq:()=>kt});var B=V(467),m=V(3953),R=V(1413);class w extends R.B{constructor(){super(...arguments),this._value=null,this._hasValue=!1,this._isComplete=!1}_checkFinalizedStatuses(i){const{hasError:r,_hasValue:e,_value:s,thrownError:n,isStopped:o,_isComplete:c}=this;r?i.error(n):(o||c)&&(e&&i.next(s),i.complete())}next(i){this.isStopped||(this._value=i,this._hasValue=!0)}complete(){const{_hasValue:i,_value:r,_isComplete:e}=this;e||(this._isComplete=!0,i&&super.next(r),super.complete())}}var j=V(4412);const C=["video"],G=["canvas"],mt=["resultsPanel"],K="assets/wasm/index.js",q="https://cdn.jsdelivr.net/npm/ngx-scanner-qrcode@1.6.9/wasm/index.js",at={audio:!1,video:!0},Z={lineWidth:1,strokeStyle:"green",fillStyle:"#55f02880"},J={font:"15px serif",strokeStyle:"#fff0",fillStyle:"#ff0000"},I={src:"",fps:30,vibrate:300,decode:"utf-8",isBeep:!0,constraints:at,canvasStyles:[Z,J]};var z=()=>"zbarWasm"in window;const d=(t,i,r)=>{r?t.error(r):t.next(i),t.complete()},$=(t=!1)=>{if(!1===t)return;const i=new Audio("data:audio/mpeg;base64,SUQzBAAAAAAAI1RTU0UAAAAPAAADTGF2ZjU4LjI5LjEwMAAAAAAAAAAAAAAA/+M4wAAAAAAAAAAAAEluZm8AAAAPAAAABQAAAkAAgICAgICAgICAgICAgICAgICAgKCgoKCgoKCgoKCgoKCgoKCgoKCgwMDAwMDAwMDAwMDAwMDAwMDAwMDg4ODg4ODg4ODg4ODg4ODg4ODg4P//////////////////////////AAAAAExhdmM1OC41NAAAAAAAAAAAAAAAACQEUQAAAAAAAAJAk0uXRQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/+MYxAANQAbGeUEQAAHZYZ3fASqD4P5TKBgocg+Bw/8+CAYBA4XB9/4EBAEP4nB9+UOf/6gfUCAIKyjgQ/Kf//wfswAAAwQA/+MYxAYOqrbdkZGQAMA7DJLCsQxNOij///////////+tv///3RWiZGBEhsf/FO/+LoCSFs1dFVS/g8f/4Mhv0nhqAieHleLy/+MYxAYOOrbMAY2gABf/////////////////usPJ66R0wI4boY9/8jQYg//g2SPx1M0N3Z0kVJLIs///Uw4aMyvHJJYmPBYG/+MYxAgPMALBucAQAoGgaBoFQVBUFQWDv6gZBUFQVBUGgaBr5YSgqCoKhIGg7+IQVBUFQVBoGga//SsFSoKnf/iVTEFNRTMu/+MYxAYAAANIAAAAADEwMFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV");i.oncanplaythrough=()=>{const r=i.play();r&&r.catch(e=>{})}},lt=(t,i,r,e)=>{let s,n,o=i.width,c=i.height,l=o/c,a=parseInt(getComputedStyle(i).width),h=parseInt(getComputedStyle(i).height),v=a/h;r.innerHTML="",l>v?(s=a/o,n=a/l/c):(n=h/c,s=h*l/o);for(let H=0;H<t.length;H++){var u;const D=t[H];let E=document.createElement("canvas"),T=E.getContext("2d",{willReadFrequently:!0}),g={},F=[],_=[],O=0,Q=0,it=2===e.length&&(null===(u=e[1])||void 0===u||null===(u=u.font)||void 0===u?void 0:u.replace(/[^0-9]/g,""));it&&/[0-9]/g.test(it)&&(O=parseFloat(it),Q=(s||1)*O,Number.isNaN(Q)&&(Q=O));const U=D.points;for(let p=0;p<U.length;p++){var A,N,S,x;const W=null!==(A=null==U||null===(N=U[p])||void 0===N?void 0:N.x)&&void 0!==A?A:0,y=null!==(S=null==U||null===(x=U[p])||void 0===x?void 0:x.y)&&void 0!==S?S:0;g[`x${p+1}`]=W,g[`y${p+1}`]=y,F.push(W),_.push(y)}let st=Math.max(...F),k=Math.min(...F),nt=Math.max(..._),P=Math.min(..._);E.setAttribute("class","qrcode-polygon"),l>v?(E.style.top=P*n+.5*(h-a/l)+"px",E.style.left=k*s+"px",E.width=(st-k)*s,E.height=(nt-P)*s):(E.style.top=P*n+"px",E.style.left=k*s+.5*(a-h*l)+"px",E.width=(st-k)*n,E.height=(nt-P)*n);for(const p in e[0])T[p]=e[0][p];const ot=[];for(let p=0;p<F.length;p++)ot.push((g[`x${p+1}`]-k)*n),ot.push((g[`y${p+1}`]-P)*s);const Y=ot.slice(0);for(T.beginPath(),T.moveTo(Y.shift(),Y.shift());Y.length;)T.lineTo(Y.shift(),Y.shift());if(T.closePath(),T.fill(),T.stroke(),O){var f,M;const p=document.createElement("div");p.setAttribute("class","qrcode-tooltip-temp"),p.innerText=D.value,p.style.maxWidth=(o>window.innerWidth?.9*window.innerWidth:o)+"px",p.style.borderRadius=`clamp(1px, ${s*O-10}px, 3px)`,p.style.paddingBlock=`clamp(1px, ${s*O-10}px, 3px)`,p.style.paddingInline=`clamp(2.5px, ${s*O-6}px, 10px)`;const W=`<svg xmlns="http://www.w3.org/2000/svg" width="${Q}" height="${Q}" viewBox="0 0 512 512"><rect x="128" y="128" width="336" height="336" rx="57" ry="57"></rect><path d="M383.5,128l.5-24a56.16,56.16,0,0,0-56-56H112a64.19,64.19,0,0,0-64,64V328a56.16,56.16,0,0,0,56,56h24"></path></svg>`,y=(new DOMParser).parseFromString(W,"application/xml"),rt=p.ownerDocument.importNode(y.documentElement,!0);rt.style.marginLeft=`clamp(1px, ${s*O-10}px, 3px)`,p.appendChild(rt),rt.addEventListener("click",()=>window.navigator.clipboard.writeText(D.value)),p.addEventListener("click",()=>window.navigator.clipboard.writeText(D.value));const b=document.createElement("div");b.setAttribute("class","qrcode-tooltip"),b.appendChild(p),n=h/c,s=h*l/o,b.style.fontSize=s*O+"px",b.style.top=P*n+"px",b.style.left=k*s+.5*(a-h*l)+"px",b.style.width=(st-k)*n+"px",b.style.height=(nt-P)*n+"px";const L=document.createElement("span");L.innerText=D.value,L.style.top=P*n+-20*n+"px",L.style.left=k*s+.5*(a-h*l)+"px";const Pt=null===(f=e[1])||void 0===f||null===(f=f.font)||void 0===f||null===(f=f.split(" "))||void 0===f?void 0:f[1];L.style.fontFamily=Pt,L.style.fontSize=s*O+"px",L.style.color=null==e||null===(M=e[1])||void 0===M?void 0:M.fillStyle,null==r||r.appendChild(b),null==r||r.appendChild(L)}null==r||r.appendChild(E)}},ct=(t,i)=>new Promise((r,e)=>t.toBlob(s=>r(s),i)),dt=(t=[],i,r,e,s=new w)=>(ht(t,r,e).then(n=>{Promise.all(Object.assign([],n).map(o=>((t,i)=>{var r,e,s;let n=null!==(r=null==i?void 0:i.decode)&&void 0!==r?r:I.decode,o=2===(null==i||null===(e=i.canvasStyles)||void 0===e?void 0:e.length)?null==i?void 0:i.canvasStyles:[Z,J],c=null!==(s=null==i?void 0:i.isBeep)&&void 0!==s?s:I.isBeep;return new Promise((l,a)=>{const h=new FileReader;h.onload=()=>{const v={name:t.name,file:t,url:URL.createObjectURL(t)},u=new Image;u.setAttribute("crossOrigin","anonymous"),u.onload=(0,B.A)(function*(){const A=document.createElement("canvas");A.width=u.naturalWidth||u.width,A.height=u.naturalHeight||u.height;const N=A.getContext("2d");N.drawImage(u,0,0,A.width,A.height);const S=N.getImageData(0,0,A.width,A.height);if(z()){const x=yield zbarWasm.scanImageData(S);if(null!=x&&x.length){x.forEach(D=>D.value=D.decode(null==n?void 0:n.toLocaleLowerCase())),((t,i,r)=>{let e=i.getContext("2d",{willReadFrequently:!0});for(let a=0;a<t.length;a++){var s;const h=t[a];let v={},u=[],A=[],N=0;const S=null===(s=r[1])||void 0===s||null===(s=s.font)||void 0===s||null===(s=s.split(" "))||void 0===s?void 0:s[0];let x=null==S?void 0:S.replace(/[^0-9]/g,"");x&&/[0-9]/g.test(x)&&(N=parseFloat(x));const f=h.points;for(let g=0;g<f.length;g++){var n,o,c,l;const F=null!==(n=null==f||null===(o=f[g])||void 0===o?void 0:o.x)&&void 0!==n?n:0,_=null!==(c=null==f||null===(l=f[g])||void 0===l?void 0:l.y)&&void 0!==c?c:0;v[`x${g+1}`]=F,v[`y${g+1}`]=_,u.push(F),A.push(_)}let M=Math.min(...u),H=Math.min(...A);const D=()=>{for(const _ in r[0])e[_]=r[0][_];const g=[];for(let _=0;_<u.length;_++)g.push(v[`x${_+1}`]),g.push(v[`y${_+1}`]);const F=g.slice(0);for(e.beginPath(),e.moveTo(F.shift(),F.shift());F.length;)e.lineTo(F.shift(),F.shift());e.closePath(),e.fill(),e.stroke()};let E=document.createElement("canvas");const T=()=>{var g;const F=null===(g=r[1])||void 0===g||null===(g=g.font)||void 0===g||null===(g=g.split(" "))||void 0===g?void 0:g[1];E.height=i.height,E.width=i.width;let _=E.getContext("2d",{willReadFrequently:!0});_.font=N+"px "+F;for(const O in r[1])_[O]=r[1][O];Dt(_,h.value,M,H-5)};D(),T(),e.drawImage(E,0,0)}})(x,A,o);const f=yield ct(A),M=URL.createObjectURL(f);l(Object.assign({},v,{data:x,url:M,canvas:A,file:(D=f,E=v.name,new File([D],E,{lastModified:(new Date).getTime(),type:D.type}))})),$(c)}else l(Object.assign({},v,{data:x,canvas:A}))}var D,E}),u.src=v.url},h.onerror=v=>a(v),h.readAsDataURL(t)})})(o,i))).then(o=>{d(s,o)}).catch(o=>d(s,null,o))}),s),Dt=(t,i,r,e)=>{let s=1.2*t.measureText("M").width,n=i.split("\n");for(var o=0;o<n.length;++o)t.fillText(n[o],r,e),t.strokeText(n[o],r,e),e+=s},ht=(t=[],i=100,r=100)=>{if(t.length&&(i<100||r<100)){const e=[];return new Promise((s,n)=>{for(const o of t){const c=new Image,l=new FileReader;l.onload=function(a){c.onload=function(){const h=document.createElement("canvas"),v=h.getContext("2d"),u=Math.round(c.width*(i/100)),A=Math.round(c.height*(i/100));h.width=u,h.height=A,v.drawImage(c,0,0,u,A),h.toBlob(N=>{const S=new File([N],o.name,{type:o.type});e.push(S),t.length===e.length&&s(e)},o.type,r/100)},c.src=a.target.result},l.onerror=a=>n(a),l.readAsDataURL(o)}})}return Promise.resolve(t)},ut=t=>{Object.assign([],t.childNodes).forEach(i=>t.removeChild(i))},tt=(t,i)=>{t.style.width=i.offsetWidth+"px",t.style.height=i.offsetHeight+"px"},At=(t=300)=>{var i;t&&Nt()&&(null===(i=window)||void 0===i||null===(i=i.navigator)||void 0===i||i.vibrate(t))},Nt=()=>{const t=navigator.userAgent||navigator.vendor||window.opera;return!(!/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(t)&&!/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw-(n|u)|c55\/|capi|ccwa|cdm-|cell|chtm|cldc|cmd-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc-s|devi|dica|dmob|do(c|p)o|ds(12|-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(-|_)|g1 u|g560|gene|gf-5|g-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd-(m|p|t)|hei-|hi(pt|ta)|hp( i|ip)|hs-c|ht(c(-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i-(20|go|ma)|i230|iac( |-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|-[a-w])|libw|lynx|m1-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|-([1-8]|c))|phil|pire|pl(ay|uc)|pn-2|po(ck|rt|se)|prox|psio|pt-g|qa-a|qc(07|12|21|32|60|-[2-7]|i-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h-|oo|p-)|sdk\/|se(c(-|0|1)|47|mc|nd|ri)|sgh-|shar|sie(-|m)|sk-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h-|v-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl-|tdg-|tel(i|m)|tim-|t-mo|to(pl|sh)|ts(70|m-|m3|m5)|tx-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas-|your|zeto|zte-/i.test(t.substr(0,4))||/^((?!chrome|android).)*safari/i.test(t))};let St=(()=>{var t;class i{loadFiles(e=[],s,n){const o=new w;return ht(e,s,n).then(c=>{Promise.all(Object.assign([],c).map(l=>this.readAsDataURL(l))).then(l=>d(o,l)).catch(l=>d(o,null,l))}),o}loadFilesToScan(e=[],s,n,o){return dt(e,s,n,o)}readAsDataURL(e){return new Promise((s,n)=>{const o=new FileReader;o.onload=()=>{const c={name:e.name,file:e,url:URL.createObjectURL(e)};s(c)},o.onerror=c=>n(c),o.readAsDataURL(e)})}}return(t=i).\u0275fac=function(e){return new(e||t)},t.\u0275prov=m.jDH({token:t,factory:t.\u0275fac,providedIn:"root"}),i})(),It=(()=>{var t;class i{constructor(e,s){this.renderer=e,this.elementRef=s,this.event=new m.bkB,this.src=I.src,this.fps=I.fps,this.vibrate=I.vibrate,this.decode=I.decode,this.isBeep=I.isBeep,this.config=I,this.constraints=I.constraints,this.canvasStyles=[Z,J],this.isStart=!1,this.isPause=!1,this.isLoading=!1,this.isTorch=!1,this.data=new j.t([]),this.devices=new j.t([]),this.deviceIndexActive=0,this.dataForResize=[],this.ready=new w,this.STATUS={startON:()=>this.isStart=!0,pauseON:()=>this.isPause=!0,loadingON:()=>this.isLoading=!0,startOFF:()=>this.isStart=!1,pauseOFF:()=>this.isPause=!1,loadingOFF:()=>this.isLoading=!1,torchOFF:()=>this.isTorch=!1}}ngOnInit(){this.overrideConfig(),((t=new w,i)=>{let r=0;const e=(s=!1)=>{const n=()=>{let l;try{const a=()=>{clearTimeout(l),z()?setTimeout(()=>d(t,!0)):l=setTimeout(()=>a())};setTimeout(()=>a()),setTimeout(()=>clearTimeout(l),3e3)}catch{clearTimeout(l)}},o=document.querySelectorAll(`script[src="${q}"]`),c=document.querySelectorAll('script[src="https://cdn.jsdelivr.net/npm/ngx-scanner-qrcode@latest/wasm/index.js"]');if(o.length||c.length)n();else{const l=document.querySelectorAll(`script[src="${K}"]`);if(1===l.length)n();else if(l.forEach(a=>a.remove()),i){const a=i.createElement("script");i.setAttribute(a,"src",s?q:K),i.setAttribute(a,"type","text/javascript"),i.setAttribute(a,"async",""),i.appendChild(document.head,a),a.onload=()=>n(),a.onerror=()=>{r<2?(document.head.removeChild(a),e(!0)):d(t,!1,q)},r+=1}else{const a=document.createElement("script");a.setAttribute("src",s?q:K),a.setAttribute("type","text/javascript"),a.setAttribute("async",""),document.head.appendChild(a),a.onload=()=>n(),a.onerror=()=>{r<2?(document.head.removeChild(a),e(!0)):d(t,!1,q)},r+=1}}};return e(),t})(this.ready,this.renderer).subscribe(()=>{this.src&&this.loadImage(this.src),this.resize()})}start(e){const s=new w;return this.isStart?d(s,!1):this.safariWebRTC(s,e),s}stop(){this.STATUS.pauseOFF(),this.STATUS.startOFF(),this.STATUS.torchOFF(),this.STATUS.loadingOFF();const e=new w;try{clearTimeout(this.rAF_ID),this.video.nativeElement.srcObject.getTracks().forEach(s=>{s.stop(),d(e,!0)}),this.dataForResize=[],(t=>{t.getContext("2d",{willReadFrequently:!0}).clearRect(0,0,t.width,t.height)})(this.canvas.nativeElement),ut(this.resultsPanel.nativeElement)}catch(s){d(e,!1,s)}return e}play(){const e=new w;return this.isPause?(this.video.nativeElement.play(),this.STATUS.pauseOFF(),this.requestAnimationFrame(),d(e,!0)):d(e,!1),e}pause(){const e=new w;return this.isStart?(clearTimeout(this.rAF_ID),this.video.nativeElement.pause(),this.STATUS.pauseON(),d(e,!0)):d(e,!1),e}playDevice(e,s=new w){const n=this.getConstraints();switch(!0){case"null"===e||"undefined"===e||!e:stop(),this.stop(),d(s,!1);break;case e&&(!this.isStart||!n||n.deviceId!==e):stop(),this.stop(),this.STATUS.loadingON(),this.deviceIndexActive=this.devices.value.findIndex(l=>l.deviceId===e);const c={...this.constraints,audio:!1,video:{deviceId:e,...this.constraints.video}};navigator.mediaDevices.getUserMedia(c).then(l=>{this.video.nativeElement.srcObject=l,this.video.nativeElement.onloadedmetadata=()=>{this.video.nativeElement.play(),this.requestAnimationFrame(),d(s,!0),this.STATUS.startON(),this.STATUS.loadingOFF()}}).catch(l=>{this.eventEmit(!1),d(s,!1,l),this.STATUS.startOFF(),this.STATUS.loadingOFF()});break;default:d(s,!1),this.STATUS.loadingOFF()}return s}loadImage(e){const s=new w;this.STATUS.startOFF(),this.STATUS.loadingON();const n=new Image;return n.setAttribute("crossOrigin","anonymous"),n.onload=()=>{z()&&this.drawImage(n,o=>{d(s,o),this.STATUS.startOFF(),this.STATUS.loadingOFF()})},n.src=e,s}torcher(){const e=this.applyConstraints({advanced:[{torch:this.isTorch}]});return e.subscribe(()=>!1,()=>this.isTorch=!this.isTorch),e}applyConstraints(e,s=0){var n=this;const o=new w;if(this.isStart){const c=this.video.nativeElement.srcObject;if(null===s&&void 0===s&&Number.isNaN(s))d(o,!1,"Please check again deviceIndex");else{const l=c.getVideoTracks()[s];new window.ImageCapture(l).getPhotoCapabilities().then((0,B.A)(function*(){yield l.applyConstraints(e),tt(n.video.nativeElement,n.canvas.nativeElement),d(o,!0)})).catch(h=>{switch(null==h?void 0:h.name){case"NotFoundError":case"DevicesNotFoundError":d(o,!1,"Required track is missing");break;case"NotReadableError":case"TrackStartError":d(o,!1,"Webcam or mic are already in use");break;case"OverconstrainedError":case"ConstraintNotSatisfiedError":d(o,!1,"Constraints can not be satisfied by avb. devices");break;case"NotAllowedError":case"PermissionDeniedError":d(o,!1,"Permission denied in browser");break;case"TypeError":d(o,!1,"Empty constraints object");break;default:d(o,!1,h)}})}}else d(o,!1,"Please start the scanner");return o}getConstraints(e=0){const s=this.video.nativeElement.srcObject,n=null==s?void 0:s.getVideoTracks()[e];return null==n?void 0:n.getConstraints()}download(e=`ngx_scanner_qrcode_${Date.now()}.png`,s,n){var o=this;const c=new w;return(0,B.A)(function*(){const a=((t,i)=>new File([t],i,{lastModified:(new Date).getTime(),type:t.type}))(yield ct(o.canvas.nativeElement),e);dt([a],o.config,s,n,c).subscribe(h=>{h.forEach(v=>{var u;if(null!=v&&null!==(u=v.data)&&void 0!==u&&u.length){const A=document.createElement("a");A.href=v.url,A.download=v.name,A.click(),A.remove()}})})})(),c}resize(){window.addEventListener("resize",()=>{lt(this.dataForResize,this.canvas.nativeElement,this.resultsPanel.nativeElement,this.canvasStyles),tt(this.video.nativeElement,this.canvas.nativeElement)})}overrideConfig(){var e;"src"in this.config&&(this.src=this.config.src),"fps"in this.config&&(this.fps=this.config.fps),"vibrate"in this.config&&(this.vibrate=this.config.vibrate),"decode"in this.config&&(this.decode=this.config.decode),"isBeep"in this.config&&(this.isBeep=this.config.isBeep),"constraints"in this.config&&(this.constraints=((t,i,r)=>{if(i&&Object.keys(i[t]).length){for(const e in r){const s=JSON.parse(JSON.stringify({...i[t],[e]:r[e]}));i[t]=i[t].hasOwnProperty(e)?i[t]:s}return i[t]}return r})("constraints",this.config,at)),"canvasStyles"in this.config&&2===(null===(e=this.config)||void 0===e||null===(e=e.canvasStyles)||void 0===e?void 0:e.length)&&(this.canvasStyles=this.config.canvasStyles)}safariWebRTC(e,s){this.STATUS.startOFF(),this.STATUS.loadingON(),navigator.mediaDevices.getUserMedia(this.constraints).then(n=>{n.getTracks().forEach(o=>o.stop()),this.loadAllDevices(e,s)}).catch(n=>{d(e,!1,n),this.STATUS.startOFF(),this.STATUS.loadingOFF()})}loadAllDevices(e,s){navigator.mediaDevices.enumerateDevices().then(n=>{let o=n.filter(c=>"videoinput"==c.kind);this.devices.next(o),(null==o?void 0:o.length)>0?(d(e,o),s?s(o):this.playDevice(o[0].deviceId)):(d(e,!1,"No camera detected."),this.STATUS.startOFF(),this.STATUS.loadingOFF())}).catch(n=>{d(e,!1,n),this.STATUS.startOFF(),this.STATUS.loadingOFF()})}drawImage(e,s=()=>{}){var n=this;return(0,B.A)(function*(){const o=n.canvas.nativeElement,c=o.getContext("2d",{willReadFrequently:!0});e instanceof HTMLImageElement&&(o.width=e.naturalWidth,o.height=e.naturalHeight,e.style.visibility="",n.video.nativeElement.style.visibility="hidden",n.renderer.setStyle(n.elementRef.nativeElement,"width",o.width+"px"),n.renderer.setStyle(n.elementRef.nativeElement,"maxWidth","100%"),n.renderer.setStyle(n.elementRef.nativeElement,"display","inline-block")),e instanceof HTMLVideoElement&&(o.width=e.videoWidth,o.height=e.videoHeight,e.style.visibility="",n.canvas.nativeElement.style.visibility="hidden"),tt(n.video.nativeElement,o),c.clearRect(0,0,o.width,o.height),c.drawImage(e,0,0,o.width,o.height);const l=c.getImageData(0,0,o.width,o.height),a=yield zbarWasm.scanImageData(l);if(null!=a&&a.length){a.forEach(v=>{var u;return v.value=v.decode(null===(u=n.decode)||void 0===u?void 0:u.toLocaleLowerCase())}),lt(a,Object.freeze(n.canvas.nativeElement),n.resultsPanel.nativeElement,n.canvasStyles);const h=()=>{n.eventEmit(a),n.dataForResize=a};e instanceof HTMLImageElement&&(s(!0),h(),At(n.vibrate),$(n.isBeep)),e instanceof HTMLVideoElement&&(h(),At(n.vibrate),$(n.isBeep))}else s(!1),ut(n.resultsPanel.nativeElement),n.dataForResize=[]})()}eventEmit(e=!1){!1!==e&&this.data.next(e||[]),!1!==e&&this.event.emit(e||[])}requestAnimationFrame(e=100){try{clearTimeout(this.rAF_ID),this.rAF_ID=setTimeout(()=>{this.video.nativeElement.readyState===this.video.nativeElement.HAVE_ENOUGH_DATA&&(e=0,z()&&this.drawImage(this.video.nativeElement),this.isStart&&!this.isPause&&this.requestAnimationFrame(e))},e||this.fps)}catch{clearTimeout(this.rAF_ID)}}get isReady(){return this.ready}ngOnDestroy(){this.pause()}}return(t=i).\u0275fac=function(e){return new(e||t)(m.rXU(m.sFG),m.rXU(m.aKT))},t.\u0275cmp=m.VBU({type:t,selectors:[["ngx-scanner-qrcode"]],viewQuery:function(e,s){if(1&e&&(m.GBs(C,5),m.GBs(G,5),m.GBs(mt,5)),2&e){let n;m.mGM(n=m.lsd())&&(s.video=n.first),m.mGM(n=m.lsd())&&(s.canvas=n.first),m.mGM(n=m.lsd())&&(s.resultsPanel=n.first)}},hostAttrs:[1,"ngx-scanner-qrcode"],inputs:{src:"src",fps:"fps",vibrate:"vibrate",decode:"decode",isBeep:"isBeep",config:"config",constraints:"constraints",canvasStyles:"canvasStyles"},outputs:{event:"event"},exportAs:["scanner"],decls:6,vars:0,consts:[["resultsPanel",""],["canvas",""],["video",""],[1,"origin-overlay"],[1,"origin-canvas"],["playsinline","",1,"origin-video"]],template:function(e,s){1&e&&m.nrm(0,"div",3,0)(2,"canvas",4,1)(4,"video",5,2)},styles:[".ngx-scanner-qrcode{display:block;position:relative}.origin-overlay{width:100%;position:absolute}.origin-overlay span{z-index:2;text-align:left;position:absolute}.origin-overlay .qrcode-polygon{z-index:1;position:absolute}.origin-canvas{width:100%;position:absolute}.origin-video{width:100%;background-color:#262626}.qrcode-tooltip{z-index:3;position:absolute}.qrcode-tooltip:hover .qrcode-tooltip-temp{display:block;position:absolute;cursor:copy}.qrcode-tooltip:hover .qrcode-tooltip-temp:active{color:#afafaf}.qrcode-tooltip .qrcode-tooltip-temp{bottom:0;left:50%;color:#fff;text-align:left;display:none;width:max-content;word-wrap:break-word;transform:translate(-50%);transform-style:preserve-3d;background-color:#000000d0;box-shadow:1px 1px 20px #000000e0}.qrcode-tooltip .qrcode-tooltip-temp svg{cursor:pointer}.qrcode-tooltip .qrcode-tooltip-temp svg rect{fill:none;stroke:#fff;stroke-linejoin:round;stroke-width:32px}.qrcode-tooltip .qrcode-tooltip-temp svg path{fill:none;stroke:#fff;stroke-linecap:round;stroke-linejoin:round;stroke-width:32px}.qrcode-tooltip .qrcode-tooltip-temp svg:active rect{stroke:#afafaf}.qrcode-tooltip .qrcode-tooltip-temp svg:active path{stroke:#afafaf}\n"],encapsulation:2}),i})(),kt=(()=>{var t;class i{}return(t=i).\u0275fac=function(e){return new(e||t)},t.\u0275mod=m.$C({type:t}),t.\u0275inj=m.G2t({providers:[St]}),i})()}}]);