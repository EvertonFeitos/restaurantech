"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[8559],{6828:(ft,X,I)=>{I.d(X,{R:()=>F});var k=I(467),m=I(3953),Z=I(8939);let F=(()=>{var V;class j{constructor(S){this.cryptoSrv=S}setItem(S,L){var T=this;return(0,k.A)(function*(){const W=yield T.cryptoSrv.encryptText(L);sessionStorage.setItem(S,W)})()}getItem(S){var L=this;return(0,k.A)(function*(){const T=sessionStorage.getItem(S);return T?yield L.cryptoSrv.decryptText(T):null})()}removeItem(S){sessionStorage.removeItem(S)}clear(){sessionStorage.clear()}}return(V=j).\u0275fac=function(S){return new(S||V)(m.KVO(Z.E))},V.\u0275prov=m.jDH({token:V,factory:V.\u0275fac,providedIn:"root"}),j})()},224:(ft,X,I)=>{I.d(X,{tc:()=>It,gq:()=>Pt});var k=I(467),m=I(3953),Z=I(1413);class F extends Z.B{constructor(){super(...arguments),this._value=null,this._hasValue=!1,this._isComplete=!1}_checkFinalizedStatuses(i){const{hasError:r,_hasValue:e,_value:s,thrownError:n,isStopped:o,_isComplete:l}=this;r?i.error(n):(o||l)&&(e&&i.next(s),i.complete())}next(i){this.isStopped||(this._value=i,this._hasValue=!0)}complete(){const{_hasValue:i,_value:r,_isComplete:e}=this;e||(this._isComplete=!0,i&&super.next(r),super.complete())}}var V=I(4412);const j=["video"],J=["canvas"],S=["resultsPanel"],L="assets/wasm/index.js",T="https://cdn.jsdelivr.net/npm/ngx-scanner-qrcode@1.6.9/wasm/index.js",lt={audio:!1,video:!0},$={lineWidth:1,strokeStyle:"green",fillStyle:"#55f02880"},tt={font:"15px serif",strokeStyle:"#fff0",fillStyle:"#ff0000"},R={src:"",fps:30,vibrate:300,decode:"utf-8",isBeep:!0,constraints:lt,canvasStyles:[$,tt]};var z=()=>"zbarWasm"in window;const d=(t,i,r)=>{r?t.error(r):t.next(i),t.complete()},et=(t=!1)=>{if(!1===t)return;const i=new Audio("data:audio/mpeg;base64,SUQzBAAAAAAAI1RTU0UAAAAPAAADTGF2ZjU4LjI5LjEwMAAAAAAAAAAAAAAA/+M4wAAAAAAAAAAAAEluZm8AAAAPAAAABQAAAkAAgICAgICAgICAgICAgICAgICAgKCgoKCgoKCgoKCgoKCgoKCgoKCgwMDAwMDAwMDAwMDAwMDAwMDAwMDg4ODg4ODg4ODg4ODg4ODg4ODg4P//////////////////////////AAAAAExhdmM1OC41NAAAAAAAAAAAAAAAACQEUQAAAAAAAAJAk0uXRQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/+MYxAANQAbGeUEQAAHZYZ3fASqD4P5TKBgocg+Bw/8+CAYBA4XB9/4EBAEP4nB9+UOf/6gfUCAIKyjgQ/Kf//wfswAAAwQA/+MYxAYOqrbdkZGQAMA7DJLCsQxNOij///////////+tv///3RWiZGBEhsf/FO/+LoCSFs1dFVS/g8f/4Mhv0nhqAieHleLy/+MYxAYOOrbMAY2gABf/////////////////usPJ66R0wI4boY9/8jQYg//g2SPx1M0N3Z0kVJLIs///Uw4aMyvHJJYmPBYG/+MYxAgPMALBucAQAoGgaBoFQVBUFQWDv6gZBUFQVBUGgaBr5YSgqCoKhIGg7+IQVBUFQVBoGga//SsFSoKnf/iVTEFNRTMu/+MYxAYAAANIAAAAADEwMFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV");i.oncanplaythrough=()=>{const r=i.play();r&&r.catch(e=>{})}},dt=(t,i,r,e)=>{let s,n,o=i.width,l=i.height,c=o/l,a=parseInt(getComputedStyle(i).width),h=parseInt(getComputedStyle(i).height),v=a/h;r.innerHTML="",c>v?(s=a/o,n=a/c/l):(n=h/l,s=h*c/o);for(let q=0;q<t.length;q++){var u;const D=t[q];let E=document.createElement("canvas"),P=E.getContext("2d",{willReadFrequently:!0}),p={},x=[],_=[],O=0,Q=0,nt=2===e.length&&(null===(u=e[1])||void 0===u||null===(u=u.font)||void 0===u?void 0:u.replace(/[^0-9]/g,""));nt&&/[0-9]/g.test(nt)&&(O=parseFloat(nt),Q=(s||1)*O,Number.isNaN(Q)&&(Q=O));const G=D.points;for(let g=0;g<G.length;g++){var A,N,C,w;const y=null!==(A=null==G||null===(N=G[g])||void 0===N?void 0:N.x)&&void 0!==A?A:0,K=null!==(C=null==G||null===(w=G[g])||void 0===w?void 0:w.y)&&void 0!==C?C:0;p[`x${g+1}`]=y,p[`y${g+1}`]=K,x.push(y),_.push(K)}let ot=Math.max(...x),M=Math.min(...x),rt=Math.max(..._),U=Math.min(..._);E.setAttribute("class","qrcode-polygon"),c>v?(E.style.top=U*n+.5*(h-a/c)+"px",E.style.left=M*s+"px",E.width=(ot-M)*s,E.height=(rt-U)*s):(E.style.top=U*n+"px",E.style.left=M*s+.5*(a-h*c)+"px",E.width=(ot-M)*n,E.height=(rt-U)*n);for(const g in e[0])P[g]=e[0][g];const at=[];for(let g=0;g<x.length;g++)at.push((p[`x${g+1}`]-M)*n),at.push((p[`y${g+1}`]-U)*s);const Y=at.slice(0);for(P.beginPath(),P.moveTo(Y.shift(),Y.shift());Y.length;)P.lineTo(Y.shift(),Y.shift());if(P.closePath(),P.fill(),P.stroke(),O){var f,B;const g=document.createElement("div");g.setAttribute("class","qrcode-tooltip-temp"),g.innerText=D.value,g.style.maxWidth=(o>window.innerWidth?.9*window.innerWidth:o)+"px",g.style.borderRadius=`clamp(1px, ${s*O-10}px, 3px)`,g.style.paddingBlock=`clamp(1px, ${s*O-10}px, 3px)`,g.style.paddingInline=`clamp(2.5px, ${s*O-6}px, 10px)`;const y=`<svg xmlns="http://www.w3.org/2000/svg" width="${Q}" height="${Q}" viewBox="0 0 512 512"><rect x="128" y="128" width="336" height="336" rx="57" ry="57"></rect><path d="M383.5,128l.5-24a56.16,56.16,0,0,0-56-56H112a64.19,64.19,0,0,0-64,64V328a56.16,56.16,0,0,0,56,56h24"></path></svg>`,K=(new DOMParser).parseFromString(y,"application/xml"),ct=g.ownerDocument.importNode(K.documentElement,!0);ct.style.marginLeft=`clamp(1px, ${s*O-10}px, 3px)`,g.appendChild(ct),ct.addEventListener("click",()=>window.navigator.clipboard.writeText(D.value)),g.addEventListener("click",()=>window.navigator.clipboard.writeText(D.value));const b=document.createElement("div");b.setAttribute("class","qrcode-tooltip"),b.appendChild(g),n=h/l,s=h*c/o,b.style.fontSize=s*O+"px",b.style.top=U*n+"px",b.style.left=M*s+.5*(a-h*c)+"px",b.style.width=(ot-M)*n+"px",b.style.height=(rt-U)*n+"px";const H=document.createElement("span");H.innerText=D.value,H.style.top=U*n+-20*n+"px",H.style.left=M*s+.5*(a-h*c)+"px";const Mt=null===(f=e[1])||void 0===f||null===(f=f.font)||void 0===f||null===(f=f.split(" "))||void 0===f?void 0:f[1];H.style.fontFamily=Mt,H.style.fontSize=s*O+"px",H.style.color=null==e||null===(B=e[1])||void 0===B?void 0:B.fillStyle,null==r||r.appendChild(b),null==r||r.appendChild(H)}null==r||r.appendChild(E)}},ht=(t,i)=>new Promise((r,e)=>t.toBlob(s=>r(s),i)),ut=(t=[],i,r,e,s=new F)=>(At(t,r,e).then(n=>{Promise.all(Object.assign([],n).map(o=>((t,i)=>{var r,e,s;let n=null!==(r=null==i?void 0:i.decode)&&void 0!==r?r:R.decode,o=2===(null==i||null===(e=i.canvasStyles)||void 0===e?void 0:e.length)?null==i?void 0:i.canvasStyles:[$,tt],l=null!==(s=null==i?void 0:i.isBeep)&&void 0!==s?s:R.isBeep;return new Promise((c,a)=>{const h=new FileReader;h.onload=()=>{const v={name:t.name,file:t,url:URL.createObjectURL(t)},u=new Image;u.setAttribute("crossOrigin","anonymous"),u.onload=(0,k.A)(function*(){const A=document.createElement("canvas");A.width=u.naturalWidth||u.width,A.height=u.naturalHeight||u.height;const N=A.getContext("2d");N.drawImage(u,0,0,A.width,A.height);const C=N.getImageData(0,0,A.width,A.height);if(z()){const w=yield zbarWasm.scanImageData(C);if(null!=w&&w.length){w.forEach(D=>D.value=D.decode(null==n?void 0:n.toLocaleLowerCase())),((t,i,r)=>{let e=i.getContext("2d",{willReadFrequently:!0});for(let a=0;a<t.length;a++){var s;const h=t[a];let v={},u=[],A=[],N=0;const C=null===(s=r[1])||void 0===s||null===(s=s.font)||void 0===s||null===(s=s.split(" "))||void 0===s?void 0:s[0];let w=null==C?void 0:C.replace(/[^0-9]/g,"");w&&/[0-9]/g.test(w)&&(N=parseFloat(w));const f=h.points;for(let p=0;p<f.length;p++){var n,o,l,c;const x=null!==(n=null==f||null===(o=f[p])||void 0===o?void 0:o.x)&&void 0!==n?n:0,_=null!==(l=null==f||null===(c=f[p])||void 0===c?void 0:c.y)&&void 0!==l?l:0;v[`x${p+1}`]=x,v[`y${p+1}`]=_,u.push(x),A.push(_)}let B=Math.min(...u),q=Math.min(...A);const D=()=>{for(const _ in r[0])e[_]=r[0][_];const p=[];for(let _=0;_<u.length;_++)p.push(v[`x${_+1}`]),p.push(v[`y${_+1}`]);const x=p.slice(0);for(e.beginPath(),e.moveTo(x.shift(),x.shift());x.length;)e.lineTo(x.shift(),x.shift());e.closePath(),e.fill(),e.stroke()};let E=document.createElement("canvas");const P=()=>{var p;const x=null===(p=r[1])||void 0===p||null===(p=p.font)||void 0===p||null===(p=p.split(" "))||void 0===p?void 0:p[1];E.height=i.height,E.width=i.width;let _=E.getContext("2d",{willReadFrequently:!0});_.font=N+"px "+x;for(const O in r[1])_[O]=r[1][O];Dt(_,h.value,B,q-5)};D(),P(),e.drawImage(E,0,0)}})(w,A,o);const f=yield ht(A),B=URL.createObjectURL(f);c(Object.assign({},v,{data:w,url:B,canvas:A,file:(D=f,E=v.name,new File([D],E,{lastModified:(new Date).getTime(),type:D.type}))})),et(l)}else c(Object.assign({},v,{data:w,canvas:A}))}var D,E}),u.src=v.url},h.onerror=v=>a(v),h.readAsDataURL(t)})})(o,i))).then(o=>{d(s,o)}).catch(o=>d(s,null,o))}),s),Dt=(t,i,r,e)=>{let s=1.2*t.measureText("M").width,n=i.split("\n");for(var o=0;o<n.length;++o)t.fillText(n[o],r,e),t.strokeText(n[o],r,e),e+=s},At=(t=[],i=100,r=100)=>{if(t.length&&(i<100||r<100)){const e=[];return new Promise((s,n)=>{for(const o of t){const l=new Image,c=new FileReader;c.onload=function(a){l.onload=function(){const h=document.createElement("canvas"),v=h.getContext("2d"),u=Math.round(l.width*(i/100)),A=Math.round(l.height*(i/100));h.width=u,h.height=A,v.drawImage(l,0,0,u,A),h.toBlob(N=>{const C=new File([N],o.name,{type:o.type});e.push(C),t.length===e.length&&s(e)},o.type,r/100)},l.src=a.target.result},c.onerror=a=>n(a),c.readAsDataURL(o)}})}return Promise.resolve(t)},vt=t=>{Object.assign([],t.childNodes).forEach(i=>t.removeChild(i))},it=(t,i)=>{t.style.width=i.offsetWidth+"px",t.style.height=i.offsetHeight+"px"},pt=(t=300)=>{var i;t&&St()&&(null===(i=window)||void 0===i||null===(i=i.navigator)||void 0===i||i.vibrate(t))},St=()=>{const t=navigator.userAgent||navigator.vendor||window.opera;return!(!/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(t)&&!/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw-(n|u)|c55\/|capi|ccwa|cdm-|cell|chtm|cldc|cmd-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc-s|devi|dica|dmob|do(c|p)o|ds(12|-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(-|_)|g1 u|g560|gene|gf-5|g-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd-(m|p|t)|hei-|hi(pt|ta)|hp( i|ip)|hs-c|ht(c(-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i-(20|go|ma)|i230|iac( |-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|-[a-w])|libw|lynx|m1-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|-([1-8]|c))|phil|pire|pl(ay|uc)|pn-2|po(ck|rt|se)|prox|psio|pt-g|qa-a|qc(07|12|21|32|60|-[2-7]|i-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h-|oo|p-)|sdk\/|se(c(-|0|1)|47|mc|nd|ri)|sgh-|shar|sie(-|m)|sk-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h-|v-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl-|tdg-|tel(i|m)|tim-|t-mo|to(pl|sh)|ts(70|m-|m3|m5)|tx-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas-|your|zeto|zte-/i.test(t.substr(0,4))||/^((?!chrome|android).)*safari/i.test(t))};let Nt=(()=>{var t;class i{loadFiles(e=[],s,n){const o=new F;return At(e,s,n).then(l=>{Promise.all(Object.assign([],l).map(c=>this.readAsDataURL(c))).then(c=>d(o,c)).catch(c=>d(o,null,c))}),o}loadFilesToScan(e=[],s,n,o){return ut(e,s,n,o)}readAsDataURL(e){return new Promise((s,n)=>{const o=new FileReader;o.onload=()=>{const l={name:e.name,file:e,url:URL.createObjectURL(e)};s(l)},o.onerror=l=>n(l),o.readAsDataURL(e)})}}return(t=i).\u0275fac=function(e){return new(e||t)},t.\u0275prov=m.jDH({token:t,factory:t.\u0275fac,providedIn:"root"}),i})(),It=(()=>{var t;class i{constructor(e,s){this.renderer=e,this.elementRef=s,this.event=new m.bkB,this.src=R.src,this.fps=R.fps,this.vibrate=R.vibrate,this.decode=R.decode,this.isBeep=R.isBeep,this.config=R,this.constraints=R.constraints,this.canvasStyles=[$,tt],this.isStart=!1,this.isPause=!1,this.isLoading=!1,this.isTorch=!1,this.data=new V.t([]),this.devices=new V.t([]),this.deviceIndexActive=0,this.dataForResize=[],this.ready=new F,this.STATUS={startON:()=>this.isStart=!0,pauseON:()=>this.isPause=!0,loadingON:()=>this.isLoading=!0,startOFF:()=>this.isStart=!1,pauseOFF:()=>this.isPause=!1,loadingOFF:()=>this.isLoading=!1,torchOFF:()=>this.isTorch=!1}}ngOnInit(){this.overrideConfig(),((t=new F,i)=>{let r=0;const e=(s=!1)=>{const n=()=>{let c;try{const a=()=>{clearTimeout(c),z()?setTimeout(()=>d(t,!0)):c=setTimeout(()=>a())};setTimeout(()=>a()),setTimeout(()=>clearTimeout(c),3e3)}catch{clearTimeout(c)}},o=document.querySelectorAll(`script[src="${T}"]`),l=document.querySelectorAll('script[src="https://cdn.jsdelivr.net/npm/ngx-scanner-qrcode@latest/wasm/index.js"]');if(o.length||l.length)n();else{const c=document.querySelectorAll(`script[src="${L}"]`);if(1===c.length)n();else if(c.forEach(a=>a.remove()),i){const a=i.createElement("script");i.setAttribute(a,"src",s?T:L),i.setAttribute(a,"type","text/javascript"),i.setAttribute(a,"async",""),i.appendChild(document.head,a),a.onload=()=>n(),a.onerror=()=>{r<2?(document.head.removeChild(a),e(!0)):d(t,!1,T)},r+=1}else{const a=document.createElement("script");a.setAttribute("src",s?T:L),a.setAttribute("type","text/javascript"),a.setAttribute("async",""),document.head.appendChild(a),a.onload=()=>n(),a.onerror=()=>{r<2?(document.head.removeChild(a),e(!0)):d(t,!1,T)},r+=1}}};return e(),t})(this.ready,this.renderer).subscribe(()=>{this.src&&this.loadImage(this.src),this.resize()})}start(e){const s=new F;return this.isStart?d(s,!1):this.safariWebRTC(s,e),s}stop(){this.STATUS.pauseOFF(),this.STATUS.startOFF(),this.STATUS.torchOFF(),this.STATUS.loadingOFF();const e=new F;try{clearTimeout(this.rAF_ID),this.video.nativeElement.srcObject.getTracks().forEach(s=>{s.stop(),d(e,!0)}),this.dataForResize=[],(t=>{t.getContext("2d",{willReadFrequently:!0}).clearRect(0,0,t.width,t.height)})(this.canvas.nativeElement),vt(this.resultsPanel.nativeElement)}catch(s){d(e,!1,s)}return e}play(){const e=new F;return this.isPause?(this.video.nativeElement.play(),this.STATUS.pauseOFF(),this.requestAnimationFrame(),d(e,!0)):d(e,!1),e}pause(){const e=new F;return this.isStart?(clearTimeout(this.rAF_ID),this.video.nativeElement.pause(),this.STATUS.pauseON(),d(e,!0)):d(e,!1),e}playDevice(e,s=new F){const n=this.getConstraints();switch(!0){case"null"===e||"undefined"===e||!e:stop(),this.stop(),d(s,!1);break;case e&&(!this.isStart||!n||n.deviceId!==e):stop(),this.stop(),this.STATUS.loadingON(),this.deviceIndexActive=this.devices.value.findIndex(c=>c.deviceId===e);const l={...this.constraints,audio:!1,video:{deviceId:e,...this.constraints.video}};navigator.mediaDevices.getUserMedia(l).then(c=>{this.video.nativeElement.srcObject=c,this.video.nativeElement.onloadedmetadata=()=>{this.video.nativeElement.play(),this.requestAnimationFrame(),d(s,!0),this.STATUS.startON(),this.STATUS.loadingOFF()}}).catch(c=>{this.eventEmit(!1),d(s,!1,c),this.STATUS.startOFF(),this.STATUS.loadingOFF()});break;default:d(s,!1),this.STATUS.loadingOFF()}return s}loadImage(e){const s=new F;this.STATUS.startOFF(),this.STATUS.loadingON();const n=new Image;return n.setAttribute("crossOrigin","anonymous"),n.onload=()=>{z()&&this.drawImage(n,o=>{d(s,o),this.STATUS.startOFF(),this.STATUS.loadingOFF()})},n.src=e,s}torcher(){const e=this.applyConstraints({advanced:[{torch:this.isTorch}]});return e.subscribe(()=>!1,()=>this.isTorch=!this.isTorch),e}applyConstraints(e,s=0){var n=this;const o=new F;if(this.isStart){const l=this.video.nativeElement.srcObject;if(null===s&&void 0===s&&Number.isNaN(s))d(o,!1,"Please check again deviceIndex");else{const c=l.getVideoTracks()[s];new window.ImageCapture(c).getPhotoCapabilities().then((0,k.A)(function*(){yield c.applyConstraints(e),it(n.video.nativeElement,n.canvas.nativeElement),d(o,!0)})).catch(h=>{switch(null==h?void 0:h.name){case"NotFoundError":case"DevicesNotFoundError":d(o,!1,"Required track is missing");break;case"NotReadableError":case"TrackStartError":d(o,!1,"Webcam or mic are already in use");break;case"OverconstrainedError":case"ConstraintNotSatisfiedError":d(o,!1,"Constraints can not be satisfied by avb. devices");break;case"NotAllowedError":case"PermissionDeniedError":d(o,!1,"Permission denied in browser");break;case"TypeError":d(o,!1,"Empty constraints object");break;default:d(o,!1,h)}})}}else d(o,!1,"Please start the scanner");return o}getConstraints(e=0){const s=this.video.nativeElement.srcObject,n=null==s?void 0:s.getVideoTracks()[e];return null==n?void 0:n.getConstraints()}download(e=`ngx_scanner_qrcode_${Date.now()}.png`,s,n){var o=this;const l=new F;return(0,k.A)(function*(){const a=((t,i)=>new File([t],i,{lastModified:(new Date).getTime(),type:t.type}))(yield ht(o.canvas.nativeElement),e);ut([a],o.config,s,n,l).subscribe(h=>{h.forEach(v=>{var u;if(null!=v&&null!==(u=v.data)&&void 0!==u&&u.length){const A=document.createElement("a");A.href=v.url,A.download=v.name,A.click(),A.remove()}})})})(),l}resize(){window.addEventListener("resize",()=>{dt(this.dataForResize,this.canvas.nativeElement,this.resultsPanel.nativeElement,this.canvasStyles),it(this.video.nativeElement,this.canvas.nativeElement)})}overrideConfig(){var e;"src"in this.config&&(this.src=this.config.src),"fps"in this.config&&(this.fps=this.config.fps),"vibrate"in this.config&&(this.vibrate=this.config.vibrate),"decode"in this.config&&(this.decode=this.config.decode),"isBeep"in this.config&&(this.isBeep=this.config.isBeep),"constraints"in this.config&&(this.constraints=((t,i,r)=>{if(i&&Object.keys(i[t]).length){for(const e in r){const s=JSON.parse(JSON.stringify({...i[t],[e]:r[e]}));i[t]=i[t].hasOwnProperty(e)?i[t]:s}return i[t]}return r})("constraints",this.config,lt)),"canvasStyles"in this.config&&2===(null===(e=this.config)||void 0===e||null===(e=e.canvasStyles)||void 0===e?void 0:e.length)&&(this.canvasStyles=this.config.canvasStyles)}safariWebRTC(e,s){this.STATUS.startOFF(),this.STATUS.loadingON(),navigator.mediaDevices.getUserMedia(this.constraints).then(n=>{n.getTracks().forEach(o=>o.stop()),this.loadAllDevices(e,s)}).catch(n=>{d(e,!1,n),this.STATUS.startOFF(),this.STATUS.loadingOFF()})}loadAllDevices(e,s){navigator.mediaDevices.enumerateDevices().then(n=>{let o=n.filter(l=>"videoinput"==l.kind);this.devices.next(o),(null==o?void 0:o.length)>0?(d(e,o),s?s(o):this.playDevice(o[0].deviceId)):(d(e,!1,"No camera detected."),this.STATUS.startOFF(),this.STATUS.loadingOFF())}).catch(n=>{d(e,!1,n),this.STATUS.startOFF(),this.STATUS.loadingOFF()})}drawImage(e,s=()=>{}){var n=this;return(0,k.A)(function*(){const o=n.canvas.nativeElement,l=o.getContext("2d",{willReadFrequently:!0});e instanceof HTMLImageElement&&(o.width=e.naturalWidth,o.height=e.naturalHeight,e.style.visibility="",n.video.nativeElement.style.visibility="hidden",n.renderer.setStyle(n.elementRef.nativeElement,"width",o.width+"px"),n.renderer.setStyle(n.elementRef.nativeElement,"maxWidth","100%"),n.renderer.setStyle(n.elementRef.nativeElement,"display","inline-block")),e instanceof HTMLVideoElement&&(o.width=e.videoWidth,o.height=e.videoHeight,e.style.visibility="",n.canvas.nativeElement.style.visibility="hidden"),it(n.video.nativeElement,o),l.clearRect(0,0,o.width,o.height),l.drawImage(e,0,0,o.width,o.height);const c=l.getImageData(0,0,o.width,o.height),a=yield zbarWasm.scanImageData(c);if(null!=a&&a.length){a.forEach(v=>{var u;return v.value=v.decode(null===(u=n.decode)||void 0===u?void 0:u.toLocaleLowerCase())}),dt(a,Object.freeze(n.canvas.nativeElement),n.resultsPanel.nativeElement,n.canvasStyles);const h=()=>{n.eventEmit(a),n.dataForResize=a};e instanceof HTMLImageElement&&(s(!0),h(),pt(n.vibrate),et(n.isBeep)),e instanceof HTMLVideoElement&&(h(),pt(n.vibrate),et(n.isBeep))}else s(!1),vt(n.resultsPanel.nativeElement),n.dataForResize=[]})()}eventEmit(e=!1){!1!==e&&this.data.next(e||[]),!1!==e&&this.event.emit(e||[])}requestAnimationFrame(e=100){try{clearTimeout(this.rAF_ID),this.rAF_ID=setTimeout(()=>{this.video.nativeElement.readyState===this.video.nativeElement.HAVE_ENOUGH_DATA&&(e=0,z()&&this.drawImage(this.video.nativeElement),this.isStart&&!this.isPause&&this.requestAnimationFrame(e))},e||this.fps)}catch{clearTimeout(this.rAF_ID)}}get isReady(){return this.ready}ngOnDestroy(){this.pause()}}return(t=i).\u0275fac=function(e){return new(e||t)(m.rXU(m.sFG),m.rXU(m.aKT))},t.\u0275cmp=m.VBU({type:t,selectors:[["ngx-scanner-qrcode"]],viewQuery:function(e,s){if(1&e&&(m.GBs(j,5),m.GBs(J,5),m.GBs(S,5)),2&e){let n;m.mGM(n=m.lsd())&&(s.video=n.first),m.mGM(n=m.lsd())&&(s.canvas=n.first),m.mGM(n=m.lsd())&&(s.resultsPanel=n.first)}},hostAttrs:[1,"ngx-scanner-qrcode"],inputs:{src:"src",fps:"fps",vibrate:"vibrate",decode:"decode",isBeep:"isBeep",config:"config",constraints:"constraints",canvasStyles:"canvasStyles"},outputs:{event:"event"},exportAs:["scanner"],decls:6,vars:0,consts:[["resultsPanel",""],["canvas",""],["video",""],[1,"origin-overlay"],[1,"origin-canvas"],["playsinline","",1,"origin-video"]],template:function(e,s){1&e&&m.nrm(0,"div",3,0)(2,"canvas",4,1)(4,"video",5,2)},styles:[".ngx-scanner-qrcode{display:block;position:relative}.origin-overlay{width:100%;position:absolute}.origin-overlay span{z-index:2;text-align:left;position:absolute}.origin-overlay .qrcode-polygon{z-index:1;position:absolute}.origin-canvas{width:100%;position:absolute}.origin-video{width:100%;background-color:#262626}.qrcode-tooltip{z-index:3;position:absolute}.qrcode-tooltip:hover .qrcode-tooltip-temp{display:block;position:absolute;cursor:copy}.qrcode-tooltip:hover .qrcode-tooltip-temp:active{color:#afafaf}.qrcode-tooltip .qrcode-tooltip-temp{bottom:0;left:50%;color:#fff;text-align:left;display:none;width:max-content;word-wrap:break-word;transform:translate(-50%);transform-style:preserve-3d;background-color:#000000d0;box-shadow:1px 1px 20px #000000e0}.qrcode-tooltip .qrcode-tooltip-temp svg{cursor:pointer}.qrcode-tooltip .qrcode-tooltip-temp svg rect{fill:none;stroke:#fff;stroke-linejoin:round;stroke-width:32px}.qrcode-tooltip .qrcode-tooltip-temp svg path{fill:none;stroke:#fff;stroke-linecap:round;stroke-linejoin:round;stroke-width:32px}.qrcode-tooltip .qrcode-tooltip-temp svg:active rect{stroke:#afafaf}.qrcode-tooltip .qrcode-tooltip-temp svg:active path{stroke:#afafaf}\n"],encapsulation:2}),i})(),Pt=(()=>{var t;class i{}return(t=i).\u0275fac=function(e){return new(e||t)},t.\u0275mod=m.$C({type:t}),t.\u0275inj=m.G2t({providers:[Nt]}),i})()}}]);